name: Keep Backend Alive

on:
  schedule:
    # Ex√©cute toutes les 5 minutes (*/5 * * * *)
    # Format: minute hour day month day-of-week
    - cron: "*/5 * * * *"
  workflow_dispatch: # Permet de d√©clencher manuellement

jobs:
  ping-backend:
    runs-on: ubuntu-latest
    environment: Production

    steps:
      - name: Ping Backend Health Endpoint
        run: |
          echo "üîÑ Ping du backend √† $(date)"

          # Remplacez cette URL par l'URL de votre backend d√©ploy√©
          BACKEND_URL="${{ secrets.BACKEND_URL || 'https://votre-backend-url.onrender.com' }}"

          response=$(curl -s -o /dev/null -w "%{http_code}" $BACKEND_URL/health)

          if [ $response -eq 200 ]; then
            echo "‚úÖ Backend actif (HTTP $response)"
          else
            echo "‚ö†Ô∏è Backend a r√©pondu avec le code HTTP $response"
          fi

      - name: Log Timestamp
        run: echo "‚è∞ Dernier ping effectu√© √† $(date -u +"%Y-%m-%d %H:%M:%S UTC")"
